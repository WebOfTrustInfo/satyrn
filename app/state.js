!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([,function(e,t){e.exports=require("showdown")},function(e,t,r){"use strict";r.r(t);const o=r(5),n=r(6);class i{constructor(e){this.satyrnicon=e,this.nodePath="node",this.proc=void 0,this.outputKey=void 0;const t=o.spawn(this.nodePath,["-i"],{});console.log("FORKED:",t),t.stdin._writableState.highWaterMark=0,t.stdout._readableState.highWaterMark=1,t.stderr._readableState.highWaterMark=1,this.proc=t;const r=this;t.stdout.on("data",e=>{console.log("KERNEL.js GOT DATA",String(e,"UTF-8")),r.outputKey?r.satyrnicon.receiveTextOutput(e,r.outputKey):r.satyrnicon.receiveUnsolicitedTextOutput(e)}),t.stdout.on("close",()=>{console.log("CLOSE")}),t.stdout.on("end",()=>{console.log("END")}),t.stdout.on("error",()=>{console.log("ERROR")}),t.stderr.on("data",e=>{console.log("ERROR"),r.outputKey?r.satyrnicon.receiveTextError(e,r.outputKey):r.satyrnicon.receiveUnsolicitedTextError(e)}),t.on("exit",(e,t)=>{r.satyrnicon.reportKernelDeath()}),t.on("close",(e,t)=>{r.satyrnicon.reportKernelDeath()}),t.on("error",e=>{console.log("FAILED TO START",e)})}run(e,t){const r=t;console.log('eval("'+r+'")'),t[t.length-1]!=n.EOL&&(t+=n.EOL),this.proc.stdin.cork();this.proc.stdin.write(t);this.proc.stdin.uncork(),console.log("RUN CODE"),this.outputKey=e}quit(){this.proc.kill()}}var l=r(1),u=r.n(l);r(1).extension("aceEditor",()=>{let e=[];return[{type:"lang",regex:/```javascript([^]+?)```/gi,replace:function(t,r){return e.push(r),"%EDITOR"+(e.length-1)+"%"}},{type:"output",filter:function(t){for(var r=0;r<e.length;++r){let n="editor-"+r;var o="<p>%EDITOR"+r+"% *</p>";t=t.replace(new RegExp(o,"gi"),a.getEditorHtml(e[r],n)),a.editors[n]=null}return e=[],t}}]});r(7),r(8);u.a.setFlavor("github");var s=new u.a.Converter({extensions:["aceEditor","mailitoEmail","anchorTarget"],tables:!0,simplifiedAutoLink:!0,smoothLivePreview:!0,tasklists:!0,parseImgDimensions:!0,strikethrough:!0,ghCodeBlocks:!0,ghMentions:!0,splitAdjacentBlockquotes:!0});const c={editors:{},state:{},isEditMode:!1,shouldRealTimeRender:!0,currentFile:"",kernel:void 0,initialiseEditors:()=>{for(let e in c.editors)c.addEditor(e)},getEditor:e=>c.editors[e],addEditor:e=>{let t=ace.edit(e);t.setTheme("ace/theme/twilight"),t.session.setMode("ace/mode/javascript"),c.editors[e]=t,c.state[e]=t.getValue()},reset:e=>{let t=c.getEditor(e);document.querySelector("#output-"+e).innerHTML="",t.setValue(c.state[e])},toggleRealTimeRender:()=>{c.shouldRealTimeRender=!c.shouldRealTimeRender,c.handleTextChange()},resetKernel:()=>{c.kernel,c.kernel=new i(c)},openFile:(e,t)=>{c.resetKernel(),c.editors={},c.currentFile=e;const r=t.toString();c.renderDocument(r),c.handleTextChange()},run:e=>{document.querySelector("#output-"+e).innerHTML="....";const t=c.getEditor(e).getValue();c.kernel.run(e,t),document.querySelector("#output-"+e).innerHTML=""},receiveTextOutput:(e,t)=>{console.log("RECIEVE ",e);const r=document.querySelector("#output-"+t).innerHTML+e;document.querySelector("#output-"+t).innerHTML=r},receiveUnsolicitedTextOutput:e=>{console.log(e)},receiveTextError:(e,t)=>{const r=document.querySelector("#output-"+t).innerHTML+e;document.querySelector("#output-"+t).innerHTML=r},receiveUnsolicitedTextError:e=>{console.log(e)},reportKernelDeath:()=>{console.log("Kernel died"),c.kernel=void 0},getEditorHtml:(e,t)=>'<div class="showdown-js-editor">\n    <div>\n    <i class="fas fa-play" onclick="state.run(\''+t+'\')" value="Run" ></i>\n    <i class="fas fa-redo" onclick="state.reset(\''+t+'\')" value="Refresh" ></i>\n    </div>\n\n    <pre id="'+t+'" class="editor">'+e+"    </pre>\n    <pre class='editor-output' id=\"output-"+t+'">\n    </pre>\n  </div>',handleTextChange:()=>{if(c.shouldRealTimeRender){const e=document.getElementById("teacher").value;c.renderDocument(e)}},renderDocument:e=>{const t=s.makeHtml(e);document.querySelector("#markdown").innerHTML=t,document.querySelector("#teacher").innerHTML=e,c.initialiseEditors()}};var a=t.default=c},,,function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("os")},function(e,t,r){r(1).extension("mailitoEmail",()=>{let e=[];return[{type:"lang",regex:/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/gi,replace:function(t,r){return e.push(t),"%EMAIL"+(e.length-1)+"%"}},{type:"output",filter:function(t){for(var r=0;r<e.length;++r){var o="%EMAIL"+r+"%";t=t.replace(new RegExp(o,"gi"),'<a href="mailto:'+e[r]+'" >'+e[r]+"</a>")}return e=[],t}}]})},function(e,t,r){r(1).extension("anchorTarget",()=>[{type:"output",regex:/<a(.*?)>(.*?)<\/a>/gi,replace:function(e){return-1===e.indexOf("target")&&-1===e.indexOf('href="#')&&-1===e.indexOf('href="mailto')&&(e=e.replace(new RegExp(/<a(.*?)>/),e=>{let t=e.slice(0,-1);return t+=' target="_blank">'})),e}}])}]);
//# sourceMappingURL=state.js.map