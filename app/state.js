!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([,function(e,t,r){"use strict";r.r(t);const n=r(7),o=r(8);class i{constructor(e){this.satyrnicon=e,this.nodePath="node",this.proc=void 0,this.outputKey=void 0;const t=n.spawn(this.nodePath,["-i"],{});console.log("FORKED:",t),t.stdin._writableState.highWaterMark=0,t.stdout._readableState.highWaterMark=1,t.stderr._readableState.highWaterMark=1,this.proc=t;const r=this;t.stdout.on("data",e=>{console.log("KERNEL.js GOT DATA",String(e,"UTF-8")),r.outputKey?r.satyrnicon.receiveTextOutput(e,r.outputKey):r.satyrnicon.receiveUnsolicitedTextOutput(e)}),t.stdout.on("close",()=>{console.log("CLOSE")}),t.stdout.on("end",()=>{console.log("END")}),t.stdout.on("error",()=>{console.log("ERROR")}),t.stdout.on("readable",()=>{console.log("READABLE")}),t.stderr.on("data",e=>{r.outputKey?r.satyrnicon.receiveTextError(e,r.outputKey):r.satyrnicon.receiveUnsolicitedTextError(e)}),t.on("exit",(e,t)=>{r.satyrnicon.reportKernelDeath()}),t.on("close",(e,t)=>{r.satyrnicon.reportKernelDeath()}),t.on("error",e=>{console.log("FAILED TO START",e)})}run(e,t){const r=t;console.log('eval("'+r+'")'),t[t.length-1]!=o.EOL&&(t+=o.EOL),this.proc.stdin.cork();const n=this.proc.stdin.write(t);console.log("RESULT",n),this.proc.stdin.uncork(),this.outputKey=e}quit(){this.proc.kill()}}var u=r(3);const l={editors:{},state:{},isEditMode:!1,shouldRealTimeRender:!0,currentFile:"",kernel:void 0,initialiseEditors:()=>{for(let e in l.editors)l.addEditor(e)},getEditor:e=>l.editors[e],addEditor:e=>{let t=ace.edit(e);t.setTheme("ace/theme/twilight"),t.session.setMode("ace/mode/javascript"),l.editors[e]=t,l.state[e]=t.getValue()},reset:e=>{let t=l.getEditor(e);document.querySelector("#output-"+e).innerHTML="",t.setValue(l.state[e])},toggleRealTimeRender:()=>{l.shouldRealTimeRender=!l.shouldRealTimeRender,l.handleTextChange()},resetKernel:()=>{l.kernel,l.kernel=new i(l)},openFile:(e,t)=>{l.resetKernel(),l.editors={},l.currentFile=e;const r=t.toString();l.renderDocument(r),l.handleTextChange()},run:e=>{document.querySelector("#output-"+e).innerHTML="....";const t=l.getEditor(e).getValue();l.kernel.run(e,t),document.querySelector("#output-"+e).innerHTML=""},receiveTextOutput:(e,t)=>{const r=document.querySelector("#output-"+t).innerHTML+e;document.querySelector("#output-"+t).innerHTML=r},receiveUnsolicitedTextOutput:e=>{console.log(e)},receiveTextError:(e,t)=>{const r=document.querySelector("#output-"+t).innerHTML+e;document.querySelector("#output-"+t).innerHTML=r},receiveUnsolicitedTextError:e=>{console.log(e)},reportKernelDeath:()=>{console.log("Kernel died"),l.kernel=void 0},getEditorHtml:(e,t)=>'<div class="showdown-js-editor">\n    <div>\n    <i class="fas fa-play" onclick="state.run(\''+t+'\')" value="Run" ></i>\n    <i class="fas fa-redo" onclick="state.reset(\''+t+'\')" value="Refresh" ></i>\n    </div>\n\n    <pre id="'+t+'" class="editor">'+e+"    </pre>\n    <pre class='editor-output' id=\"output-"+t+'">\n    </pre>\n  </div>',handleTextChange:()=>{if(l.shouldRealTimeRender){const e=document.getElementById("teacher").value;l.renderDocument(e)}},renderDocument:e=>{const t=u.a.makeHtml(e);document.querySelector("#markdown").innerHTML=t,document.querySelector("#teacher").innerHTML=e,l.initialiseEditors()}};t.default=l},function(e,t){e.exports=require("showdown")},function(e,t,r){"use strict";var n=r(2),o=r.n(n),i=r(1);r(2).extension("aceEditor",()=>{let e=[];return[{type:"lang",regex:/```javascript([^]+?)```/gi,replace:function(t,r){return e.push(r),"%EDITOR"+(e.length-1)+"%"}},{type:"output",filter:function(t){for(var r=0;r<e.length;++r){let o="editor-"+r;var n="<p>%EDITOR"+r+"% *</p>";t=t.replace(new RegExp(n,"gi"),i.default.getEditorHtml(e[r],o)),i.default.editors[o]=null}return e=[],t}}]});r(9),r(10);const u=new o.a.Converter({extensions:["aceEditor","mailitoEmail","anchorTarget"]});t.a=u},,,,function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("os")},function(e,t,r){r(2).extension("mailitoEmail",()=>{let e=[];return[{type:"lang",regex:/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/gi,replace:function(t,r){return e.push(t),"%EMAIL"+(e.length-1)+"%"}},{type:"output",filter:function(t){for(var r=0;r<e.length;++r){var n="%EMAIL"+r+"%";t=t.replace(new RegExp(n,"gi"),'<a href="mailto:'+e[r]+'" >'+e[r]+"</a>")}return e=[],t}}]})},function(e,t,r){r(2).extension("anchorTarget",()=>[{type:"output",regex:/<a(.*?)>(.*?)<\/a>/gi,replace:function(e){return-1===e.indexOf("target")&&-1===e.indexOf('href="#')&&-1===e.indexOf('href="mailto')&&(e=e.replace(new RegExp(/<a(.*?)>/),e=>{let t=e.slice(0,-1);return t+=' target="_blank">'})),e}}])}]);
//# sourceMappingURL=state.js.map